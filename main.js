(()=>{"use strict";class t{#t;length;coords;constructor(t){if(t<=0)throw new RangeError("Ship length must be greater than 0");this.#t=0,this.length=t}get hits(){return this.#t}hit(){this.isSunk()||this.#t++}isSunk(){return this.hits>=this.length}}class e{state;owner;constructor(){this.owner=null,this.state="empty"}}class r{shipCount;ships;grid;constructor(){this.shipCount=0,this.ships=[],this.grid=Array.from({length:10},()=>Array.from({length:10},()=>new e))}placeShip(t,e,r,i="horizontal"){if(!this.#e(e,r))throw new RangeError(`(${e}, ${r}) : coordinates out of bounds`);if(!this.#r(e,r,t.length,i))throw new Error(`Ship of length ${t.length} does not fit at (${e}, ${r}) in direction ${i}`);if(this.#i(e,r,t.length,i))throw new Error(`Ship overlaps another ship at (${e}, ${r})`);for(let n=0;n<t.length;n++){const o="vertical"===i?e+n:e,s="horizontal"===i?r+n:r,a=this.grid[o][s];a.owner=t,a.state="occupied"}this.ships.push(t),this.shipCount++}findShipAt(t,e){return this.#e(t,e)?this.grid[t][e].owner??-1:-1}receiveAttack(e,r){if(!this.#e(e,r))return;const i=this.grid[e][r],n=i.owner;if(null!==n){if(!(n instanceof t))throw new TypeError("receiveAttack expects a Ship instance at the target cell");n.isSunk()?i.state="miss":(n.hit(),i.state="hit")}else i.state="miss"}printBoard(){let t="♯  0 1 2 3 4 5 6 7 8 9\n";for(let e=0;e<10;e++){let r=`${e}  `;for(let t=0;t<10;t++){let i;switch(this.grid[e][t].state){case"empty":i=".";break;case"occupied":i="⛴";break;case"hit":i="♰";break;case"miss":i="✘";break;default:i="?"}r+=i+" "}t+=r+"\n"}console.log(t)}checkIfAllShipsAreSunk(){return this.ships.every(t=>t.isSunk())}#e(t,e){return Number.isInteger(t)&&Number.isInteger(e)&&t>=0&&t<this.grid.length&&e>=0&&e<this.grid[0].length}#r(t,e,r,i){return"horizontal"===i?e+r<=10:"vertical"===i&&t+r<=10}#i(t,e,r,i){for(let n=0;n<r;n++){const r="vertical"===i?t+n:t,o="horizontal"===i?e+n:e;if(null!==this.grid[r][o].owner)return!0}return!1}}class i{constructor(t="human"){this.type=t}board=new r}function n(t,e,{hideShips:r=!1}={}){const i=document.getElementById(e);if(i){i.innerHTML="";for(let e=0;e<10;e++)for(let n=0;n<10;n++){const o=document.createElement("div");o.classList.add("cell"),o.dataset.row=e,o.dataset.col=n;const s=t.grid[e][n];"occupied"===s.state?r?o.classList.add("empty"):o.classList.add("occupied"):"empty"===s.state?o.classList.add("empty"):"hit"===s.state?o.classList.add("hit"):"miss"===s.state&&o.classList.add("miss"),i.appendChild(o)}}}function o(e,{noTouch:r=!1}={}){const i=[5,4,3,3,2];for(const n of i){let i=!1,o=0;for(;!i&&o<200;){o++;const a=Math.random()<.5?"horizontal":"vertical",h=Math.floor(10*Math.random()),c=Math.floor(10*Math.random());try{if(r&&!s(e,h,c,n,a))continue;const o=new t(n);e.placeShip(o,h,c,a),i=!0}catch(t){}}if(!i)throw new Error(`Could not place ship of length ${n}`)}}function s(t,e,r,i,n){const o=e,s=r,a="vertical"===n?e+i-1:e,h="horizontal"===n?r+i-1:r,c=Math.max(0,o-1),d=Math.max(0,s-1),l=Math.min(t.grid.length-1,a+1),u=Math.min(t.grid[0].length-1,h+1);for(let e=c;e<=l;e++)for(let r=d;r<=u;r++)if(null!==t.grid[e][r].owner)return!1;return!(o<0||s<0||a>=t.grid.length||h>=t.grid[0].length)}function a(){!function(t="player-grid",e="computer-grid"){const r=new i("human"),s=new i("computer");o(r.board,{noTouch:!0}),o(s.board),n(r.board,t,{hideShips:!1}),n(s.board,e,{hideShips:!0});const a=document.getElementById(e),h=document.getElementById(t),c=document.getElementById("game-message"),d=document.getElementById("turn-indicator"),l=document.getElementById("regen-player");let u=!1;function m(t){c&&(c.textContent=t||"")}function g(t){d&&(d.textContent=t||"")}function f(t,e){t&&(e?t.classList.add("disabled"):t.classList.remove("disabled"))}g("Current Turn: You"),m("Place your attack on the computer board."),a&&a.addEventListener("click",i=>{if(u)return;const o=i.target.closest(".cell");if(!o)return;const c=Number(o.dataset.row),d=Number(o.dataset.col),l=s.board.grid[c][d];if("hit"!==l.state&&"miss"!==l.state){if(s.board.receiveAttack(c,d),n(s.board,e,{hideShips:!0}),s.board.checkIfAllShipsAreSunk())return m("You win!"),g("Game Over"),f(a,!0),f(h,!0),void(u=!0);u=!0,g("Current Turn: Computer"),m("Computer is thinking..."),f(a,!0),f(h,!0),setTimeout(()=>{const{x:e,y:i}=function(t){let e,r;do{e=Math.floor(10*Math.random()),r=Math.floor(10*Math.random())}while("hit"===t.grid[e][r].state||"miss"===t.grid[e][r].state);return{x:e,y:r}}(r.board);if(r.board.receiveAttack(e,i),n(r.board,t,{hideShips:!1}),r.board.checkIfAllShipsAreSunk())return m("Computer wins!"),g("Game Over"),f(a,!0),f(h,!0),void(u=!0);u=!1,g("Current Turn: You"),m("Your move."),f(a,!1),f(h,!1)},600)}}),l&&l.addEventListener("click",()=>{if(u)return;u=!0,m("Shuffling your ships..."),f(a,!0),f(h,!0);const e=new i("human");o(e.board,{noTouch:!0}),r.board=e.board,n(r.board,t,{hideShips:!1}),setTimeout(()=>{m("Your ships have been shuffled."),f(a,!1),f(h,!1),u=!1},200)})}("player-grid","computer-grid")}"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",a):a())})();